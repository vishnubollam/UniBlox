"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SdkToCliLogger = void 0;
exports.formatSdkLoggerContent = formatSdkLoggerContent;
const util_1 = require("util");
const serialize_1 = require("../../serialize");
class SdkToCliLogger {
    constructor(ioHost) {
        this.ioHost = ioHost;
    }
    notify(level, ...content) {
        void this.ioHost.notify({
            time: new Date(),
            level: 'trace', // always log all SDK logs at trace level, no matter what level they are coming from the SDK
            action: 'none',
            code: 'CDK_SDK_I0000',
            message: (0, util_1.format)('[SDK %s] %s', level, formatSdkLoggerContent(content)),
        });
    }
    trace(..._content) {
        // This is too much detail for our logs
        // this.notify('trace', ...content);
    }
    debug(..._content) {
        // This is too much detail for our logs
        // this.notify('debug', ...content);
    }
    /**
     * Info is called mostly (exclusively?) for successful API calls
     *
     * Payload:
     *
     * (Note the input contains entire CFN templates, for example)
     *
     * ```
     * {
     *   clientName: 'S3Client',
     *   commandName: 'GetBucketLocationCommand',
     *   input: {
     *     Bucket: '.....',
     *     ExpectedBucketOwner: undefined
     *   },
     *   output: { LocationConstraint: 'eu-central-1' },
     *   metadata: {
     *     httpStatusCode: 200,
     *     requestId: '....',
     *     extendedRequestId: '...',
     *     cfId: undefined,
     *     attempts: 1,
     *     totalRetryDelay: 0
     *   }
     * }
     * ```
     */
    info(...content) {
        this.notify('info', ...content);
    }
    warn(...content) {
        this.notify('warn', ...content);
    }
    /**
     * Error is called mostly (exclusively?) for failing API calls
     *
     * Payload (input would be the entire API call arguments).
     *
     * ```
     * {
     *   clientName: 'STSClient',
     *   commandName: 'GetCallerIdentityCommand',
     *   input: {},
     *   error: AggregateError [ECONNREFUSED]:
     *       at internalConnectMultiple (node:net:1121:18)
     *       at afterConnectMultiple (node:net:1688:7) {
     *     code: 'ECONNREFUSED',
     *     '$metadata': { attempts: 3, totalRetryDelay: 600 },
     *     [errors]: [ [Error], [Error] ]
     *   },
     *   metadata: { attempts: 3, totalRetryDelay: 600 }
     * }
     * ```
     */
    error(...content) {
        this.notify('error', ...content);
    }
}
exports.SdkToCliLogger = SdkToCliLogger;
/**
 * This can be anything.
 *
 * For debug, it seems to be mostly strings.
 * For info, it seems to be objects.
 *
 * Stringify and join without separator.
 */
function formatSdkLoggerContent(content) {
    if (content.length === 1) {
        const apiFmt = formatApiCall(content[0]);
        if (apiFmt) {
            return apiFmt;
        }
    }
    return content.map((x) => typeof x === 'string' ? x : (0, util_1.inspect)(x)).join('');
}
function formatApiCall(content) {
    var _a, _b, _c, _d;
    if (!isSdkApiCallSuccess(content) && !isSdkApiCallError(content)) {
        return undefined;
    }
    const service = content.clientName.replace(/Client$/, '');
    const api = content.commandName.replace(/Command$/, '');
    const parts = [];
    if (((_b = (_a = content.metadata) === null || _a === void 0 ? void 0 : _a.attempts) !== null && _b !== void 0 ? _b : 0) > 1) {
        parts.push(`[${(_c = content.metadata) === null || _c === void 0 ? void 0 : _c.attempts} attempts, ${(_d = content.metadata) === null || _d === void 0 ? void 0 : _d.totalRetryDelay}ms retry]`);
    }
    parts.push(`${service}.${api}(${JSON.stringify(content.input, serialize_1.replacerBufferWithInfo)})`);
    if (isSdkApiCallSuccess(content)) {
        parts.push('-> OK');
    }
    else {
        parts.push(`-> ${content.error}`);
    }
    return parts.join(' ');
}
function isSdkApiCallSuccess(x) {
    return x && typeof x === 'object' && x.commandName && x.output;
}
function isSdkApiCallError(x) {
    return x && typeof x === 'object' && x.commandName && x.error;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2RrLWxvZ2dlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInNkay1sb2dnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBcUdBLHdEQVFDO0FBN0dELCtCQUF1QztBQUV2QywrQ0FBeUQ7QUFHekQsTUFBYSxjQUFjO0lBR3pCLFlBQW1CLE1BQWU7UUFDaEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7SUFDdkIsQ0FBQztJQUVPLE1BQU0sQ0FBQyxLQUEwQyxFQUFFLEdBQUcsT0FBYztRQUMxRSxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDO1lBQ3RCLElBQUksRUFBRSxJQUFJLElBQUksRUFBRTtZQUNoQixLQUFLLEVBQUUsT0FBTyxFQUFFLDRGQUE0RjtZQUM1RyxNQUFNLEVBQUUsTUFBYTtZQUNyQixJQUFJLEVBQUUsZUFBZTtZQUNyQixPQUFPLEVBQUUsSUFBQSxhQUFNLEVBQUMsYUFBYSxFQUFFLEtBQUssRUFBRSxzQkFBc0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUN2RSxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRU0sS0FBSyxDQUFDLEdBQUcsUUFBZTtRQUM3Qix1Q0FBdUM7UUFDdkMsb0NBQW9DO0lBQ3RDLENBQUM7SUFFTSxLQUFLLENBQUMsR0FBRyxRQUFlO1FBQzdCLHVDQUF1QztRQUN2QyxvQ0FBb0M7SUFDdEMsQ0FBQztJQUVEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztPQTBCRztJQUNJLElBQUksQ0FBQyxHQUFHLE9BQWM7UUFDM0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRU0sSUFBSSxDQUFDLEdBQUcsT0FBYztRQUMzQixJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0FvQkc7SUFDSSxLQUFLLENBQUMsR0FBRyxPQUFjO1FBQzVCLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLEdBQUcsT0FBTyxDQUFDLENBQUM7SUFDbkMsQ0FBQztDQUNGO0FBdEZELHdDQXNGQztBQUVEOzs7Ozs7O0dBT0c7QUFDSCxTQUFnQixzQkFBc0IsQ0FBQyxPQUFjO0lBQ25ELElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUN6QixNQUFNLE1BQU0sR0FBRyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekMsSUFBSSxNQUFNLEVBQUUsQ0FBQztZQUNYLE9BQU8sTUFBTSxDQUFDO1FBQ2hCLENBQUM7SUFDSCxDQUFDO0lBQ0QsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBQSxjQUFPLEVBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDN0UsQ0FBQztBQUVELFNBQVMsYUFBYSxDQUFDLE9BQVk7O0lBQ2pDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7UUFDakUsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUVELE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMxRCxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFFeEQsTUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDO0lBQ2pCLElBQUksQ0FBQyxNQUFBLE1BQUEsT0FBTyxDQUFDLFFBQVEsMENBQUUsUUFBUSxtQ0FBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUMxQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksTUFBQSxPQUFPLENBQUMsUUFBUSwwQ0FBRSxRQUFRLGNBQWMsTUFBQSxPQUFPLENBQUMsUUFBUSwwQ0FBRSxlQUFlLFdBQVcsQ0FBQyxDQUFDO0lBQ3ZHLENBQUM7SUFFRCxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsT0FBTyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsa0NBQXNCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFMUYsSUFBSSxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQ2pDLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDdEIsQ0FBQztTQUFNLENBQUM7UUFDTixLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVELE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUN6QixDQUFDO0FBbUJELFNBQVMsbUJBQW1CLENBQUMsQ0FBTTtJQUNqQyxPQUFPLENBQUMsSUFBSSxPQUFPLENBQUMsS0FBSyxRQUFRLElBQUksQ0FBQyxDQUFDLFdBQVcsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ2pFLENBQUM7QUFFRCxTQUFTLGlCQUFpQixDQUFDLENBQU07SUFDL0IsT0FBTyxDQUFDLElBQUksT0FBTyxDQUFDLEtBQUssUUFBUSxJQUFJLENBQUMsQ0FBQyxXQUFXLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUNoRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5zcGVjdCwgZm9ybWF0IH0gZnJvbSAndXRpbCc7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tICdAc21pdGh5L3R5cGVzJztcbmltcG9ydCB7IHJlcGxhY2VyQnVmZmVyV2l0aEluZm8gfSBmcm9tICcuLi8uLi9zZXJpYWxpemUnO1xuaW1wb3J0IHR5cGUgeyBJSW9Ib3N0IH0gZnJvbSAnLi4vLi4vdG9vbGtpdC9jbGktaW8taG9zdCc7XG5cbmV4cG9ydCBjbGFzcyBTZGtUb0NsaUxvZ2dlciBpbXBsZW1lbnRzIExvZ2dlciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgaW9Ib3N0OiBJSW9Ib3N0O1xuXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvcihpb0hvc3Q6IElJb0hvc3QpIHtcbiAgICB0aGlzLmlvSG9zdCA9IGlvSG9zdDtcbiAgfVxuXG4gIHByaXZhdGUgbm90aWZ5KGxldmVsOiAnZGVidWcnIHwgJ2luZm8nIHwgJ3dhcm4nIHwgJ2Vycm9yJywgLi4uY29udGVudDogYW55W10pIHtcbiAgICB2b2lkIHRoaXMuaW9Ib3N0Lm5vdGlmeSh7XG4gICAgICB0aW1lOiBuZXcgRGF0ZSgpLFxuICAgICAgbGV2ZWw6ICd0cmFjZScsIC8vIGFsd2F5cyBsb2cgYWxsIFNESyBsb2dzIGF0IHRyYWNlIGxldmVsLCBubyBtYXR0ZXIgd2hhdCBsZXZlbCB0aGV5IGFyZSBjb21pbmcgZnJvbSB0aGUgU0RLXG4gICAgICBhY3Rpb246ICdub25lJyBhcyBhbnksXG4gICAgICBjb2RlOiAnQ0RLX1NES19JMDAwMCcsXG4gICAgICBtZXNzYWdlOiBmb3JtYXQoJ1tTREsgJXNdICVzJywgbGV2ZWwsIGZvcm1hdFNka0xvZ2dlckNvbnRlbnQoY29udGVudCkpLFxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHRyYWNlKC4uLl9jb250ZW50OiBhbnlbXSkge1xuICAgIC8vIFRoaXMgaXMgdG9vIG11Y2ggZGV0YWlsIGZvciBvdXIgbG9nc1xuICAgIC8vIHRoaXMubm90aWZ5KCd0cmFjZScsIC4uLmNvbnRlbnQpO1xuICB9XG5cbiAgcHVibGljIGRlYnVnKC4uLl9jb250ZW50OiBhbnlbXSkge1xuICAgIC8vIFRoaXMgaXMgdG9vIG11Y2ggZGV0YWlsIGZvciBvdXIgbG9nc1xuICAgIC8vIHRoaXMubm90aWZ5KCdkZWJ1ZycsIC4uLmNvbnRlbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluZm8gaXMgY2FsbGVkIG1vc3RseSAoZXhjbHVzaXZlbHk/KSBmb3Igc3VjY2Vzc2Z1bCBBUEkgY2FsbHNcbiAgICpcbiAgICogUGF5bG9hZDpcbiAgICpcbiAgICogKE5vdGUgdGhlIGlucHV0IGNvbnRhaW5zIGVudGlyZSBDRk4gdGVtcGxhdGVzLCBmb3IgZXhhbXBsZSlcbiAgICpcbiAgICogYGBgXG4gICAqIHtcbiAgICogICBjbGllbnROYW1lOiAnUzNDbGllbnQnLFxuICAgKiAgIGNvbW1hbmROYW1lOiAnR2V0QnVja2V0TG9jYXRpb25Db21tYW5kJyxcbiAgICogICBpbnB1dDoge1xuICAgKiAgICAgQnVja2V0OiAnLi4uLi4nLFxuICAgKiAgICAgRXhwZWN0ZWRCdWNrZXRPd25lcjogdW5kZWZpbmVkXG4gICAqICAgfSxcbiAgICogICBvdXRwdXQ6IHsgTG9jYXRpb25Db25zdHJhaW50OiAnZXUtY2VudHJhbC0xJyB9LFxuICAgKiAgIG1ldGFkYXRhOiB7XG4gICAqICAgICBodHRwU3RhdHVzQ29kZTogMjAwLFxuICAgKiAgICAgcmVxdWVzdElkOiAnLi4uLicsXG4gICAqICAgICBleHRlbmRlZFJlcXVlc3RJZDogJy4uLicsXG4gICAqICAgICBjZklkOiB1bmRlZmluZWQsXG4gICAqICAgICBhdHRlbXB0czogMSxcbiAgICogICAgIHRvdGFsUmV0cnlEZWxheTogMFxuICAgKiAgIH1cbiAgICogfVxuICAgKiBgYGBcbiAgICovXG4gIHB1YmxpYyBpbmZvKC4uLmNvbnRlbnQ6IGFueVtdKSB7XG4gICAgdGhpcy5ub3RpZnkoJ2luZm8nLCAuLi5jb250ZW50KTtcbiAgfVxuXG4gIHB1YmxpYyB3YXJuKC4uLmNvbnRlbnQ6IGFueVtdKSB7XG4gICAgdGhpcy5ub3RpZnkoJ3dhcm4nLCAuLi5jb250ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFcnJvciBpcyBjYWxsZWQgbW9zdGx5IChleGNsdXNpdmVseT8pIGZvciBmYWlsaW5nIEFQSSBjYWxsc1xuICAgKlxuICAgKiBQYXlsb2FkIChpbnB1dCB3b3VsZCBiZSB0aGUgZW50aXJlIEFQSSBjYWxsIGFyZ3VtZW50cykuXG4gICAqXG4gICAqIGBgYFxuICAgKiB7XG4gICAqICAgY2xpZW50TmFtZTogJ1NUU0NsaWVudCcsXG4gICAqICAgY29tbWFuZE5hbWU6ICdHZXRDYWxsZXJJZGVudGl0eUNvbW1hbmQnLFxuICAgKiAgIGlucHV0OiB7fSxcbiAgICogICBlcnJvcjogQWdncmVnYXRlRXJyb3IgW0VDT05OUkVGVVNFRF06XG4gICAqICAgICAgIGF0IGludGVybmFsQ29ubmVjdE11bHRpcGxlIChub2RlOm5ldDoxMTIxOjE4KVxuICAgKiAgICAgICBhdCBhZnRlckNvbm5lY3RNdWx0aXBsZSAobm9kZTpuZXQ6MTY4ODo3KSB7XG4gICAqICAgICBjb2RlOiAnRUNPTk5SRUZVU0VEJyxcbiAgICogICAgICckbWV0YWRhdGEnOiB7IGF0dGVtcHRzOiAzLCB0b3RhbFJldHJ5RGVsYXk6IDYwMCB9LFxuICAgKiAgICAgW2Vycm9yc106IFsgW0Vycm9yXSwgW0Vycm9yXSBdXG4gICAqICAgfSxcbiAgICogICBtZXRhZGF0YTogeyBhdHRlbXB0czogMywgdG90YWxSZXRyeURlbGF5OiA2MDAgfVxuICAgKiB9XG4gICAqIGBgYFxuICAgKi9cbiAgcHVibGljIGVycm9yKC4uLmNvbnRlbnQ6IGFueVtdKSB7XG4gICAgdGhpcy5ub3RpZnkoJ2Vycm9yJywgLi4uY29udGVudCk7XG4gIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNhbiBiZSBhbnl0aGluZy5cbiAqXG4gKiBGb3IgZGVidWcsIGl0IHNlZW1zIHRvIGJlIG1vc3RseSBzdHJpbmdzLlxuICogRm9yIGluZm8sIGl0IHNlZW1zIHRvIGJlIG9iamVjdHMuXG4gKlxuICogU3RyaW5naWZ5IGFuZCBqb2luIHdpdGhvdXQgc2VwYXJhdG9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0U2RrTG9nZ2VyQ29udGVudChjb250ZW50OiBhbnlbXSkge1xuICBpZiAoY29udGVudC5sZW5ndGggPT09IDEpIHtcbiAgICBjb25zdCBhcGlGbXQgPSBmb3JtYXRBcGlDYWxsKGNvbnRlbnRbMF0pO1xuICAgIGlmIChhcGlGbXQpIHtcbiAgICAgIHJldHVybiBhcGlGbXQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBjb250ZW50Lm1hcCgoeCkgPT4gdHlwZW9mIHggPT09ICdzdHJpbmcnID8geCA6IGluc3BlY3QoeCkpLmpvaW4oJycpO1xufVxuXG5mdW5jdGlvbiBmb3JtYXRBcGlDYWxsKGNvbnRlbnQ6IGFueSk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIGlmICghaXNTZGtBcGlDYWxsU3VjY2Vzcyhjb250ZW50KSAmJiAhaXNTZGtBcGlDYWxsRXJyb3IoY29udGVudCkpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc3Qgc2VydmljZSA9IGNvbnRlbnQuY2xpZW50TmFtZS5yZXBsYWNlKC9DbGllbnQkLywgJycpO1xuICBjb25zdCBhcGkgPSBjb250ZW50LmNvbW1hbmROYW1lLnJlcGxhY2UoL0NvbW1hbmQkLywgJycpO1xuXG4gIGNvbnN0IHBhcnRzID0gW107XG4gIGlmICgoY29udGVudC5tZXRhZGF0YT8uYXR0ZW1wdHMgPz8gMCkgPiAxKSB7XG4gICAgcGFydHMucHVzaChgWyR7Y29udGVudC5tZXRhZGF0YT8uYXR0ZW1wdHN9IGF0dGVtcHRzLCAke2NvbnRlbnQubWV0YWRhdGE/LnRvdGFsUmV0cnlEZWxheX1tcyByZXRyeV1gKTtcbiAgfVxuXG4gIHBhcnRzLnB1c2goYCR7c2VydmljZX0uJHthcGl9KCR7SlNPTi5zdHJpbmdpZnkoY29udGVudC5pbnB1dCwgcmVwbGFjZXJCdWZmZXJXaXRoSW5mbyl9KWApO1xuXG4gIGlmIChpc1Nka0FwaUNhbGxTdWNjZXNzKGNvbnRlbnQpKSB7XG4gICAgcGFydHMucHVzaCgnLT4gT0snKTtcbiAgfSBlbHNlIHtcbiAgICBwYXJ0cy5wdXNoKGAtPiAke2NvbnRlbnQuZXJyb3J9YCk7XG4gIH1cblxuICByZXR1cm4gcGFydHMuam9pbignICcpO1xufVxuXG5pbnRlcmZhY2UgU2RrQXBpQ2FsbEJhc2Uge1xuICBjbGllbnROYW1lOiBzdHJpbmc7XG4gIGNvbW1hbmROYW1lOiBzdHJpbmc7XG4gIGlucHV0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgbWV0YWRhdGE/OiB7XG4gICAgaHR0cFN0YXR1c0NvZGU/OiBudW1iZXI7XG4gICAgcmVxdWVzdElkPzogc3RyaW5nO1xuICAgIGV4dGVuZGVkUmVxdWVzdElkPzogc3RyaW5nO1xuICAgIGNmSWQ/OiBzdHJpbmc7XG4gICAgYXR0ZW1wdHM/OiBudW1iZXI7XG4gICAgdG90YWxSZXRyeURlbGF5PzogbnVtYmVyO1xuICB9O1xufVxuXG50eXBlIFNka0FwaUNhbGxTdWNjZXNzID0gU2RrQXBpQ2FsbEJhc2UgJiB7IG91dHB1dDogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfTtcbnR5cGUgU2RrQXBpQ2FsbEVycm9yID0gU2RrQXBpQ2FsbEJhc2UgJiB7IGVycm9yOiBFcnJvciB9O1xuXG5mdW5jdGlvbiBpc1Nka0FwaUNhbGxTdWNjZXNzKHg6IGFueSk6IHggaXMgU2RrQXBpQ2FsbFN1Y2Nlc3Mge1xuICByZXR1cm4geCAmJiB0eXBlb2YgeCA9PT0gJ29iamVjdCcgJiYgeC5jb21tYW5kTmFtZSAmJiB4Lm91dHB1dDtcbn1cblxuZnVuY3Rpb24gaXNTZGtBcGlDYWxsRXJyb3IoeDogYW55KTogeCBpcyBTZGtBcGlDYWxsRXJyb3Ige1xuICByZXR1cm4geCAmJiB0eXBlb2YgeCA9PT0gJ29iamVjdCcgJiYgeC5jb21tYW5kTmFtZSAmJiB4LmVycm9yO1xufVxuIl19